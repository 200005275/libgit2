FILE(GLOB SRC_NTLMCLIENT "ntlm.c" "unicode_builtin.c" "util.c")

IF(HTTPS_BACKEND STREQUAL "SecureTransport")
	ADD_DEFINITIONS(-DCRYPT_COMMONCRYPTO)
	SET(SRC_NTLMCLIENT_CRYPTO "crypt_commoncrypto.c")
ELSEIF(HTTPS_BACKEND STREQUAL "OpenSSL")
	ADD_DEFINITIONS(-DCRYPT_OPENSSL)
	SET(SRC_NTLMCLIENT_CRYPTO "crypt_openssl.c")
ELSEIF(HTTPS_BACKEND STREQUAL "mbledTLS")
	ADD_DEFINITIONS(-DCRYPT_MBEDTLS)
	SET(SRC_NTLMCLIENT_CRYPTO "crypt_mbedtls.c")
ELSE()
	MESSAGE(FATAL_ERROR "Unable to use libgit2's HTTPS backend for NTLM crypto")
ENDIF()

ADD_LIBRARY(ntlmclient OBJECT ${SRC_NTLMCLIENT} ${SRC_NTLMCLIENT_CRYPTO})
